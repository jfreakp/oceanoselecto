{% extends 'base.html' %}
{% block title %}Login{% endblock %}
{% block content %}
<div class="relative flex min-h-screen w-full flex-col bg-background-light dark:bg-background-dark overflow-x-hidden">
  <div class="absolute inset-0 z-0 h-full w-full bg-center bg-no-repeat bg-cover opacity-10 dark:opacity-5" aria-hidden="true"
       style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuB_JTXt78wA5Oeea_Khc45VMRL3IURmw-x7-aseprhyM4onFmahWnVNQYcATGwnEyjoN-S3sOfusXT9whd4Cs938VJ7GMmV2INUkaTbETElZ7zPaIAWUqpV3gpN8dwCfZmAN_GysPajlsOZdjqmsDBs3aN9z0PUWPZAD6vZulmWlh2LEFl-Hu3XHhzRI40mWoskPFRT2MdX9UgfBgtbaDFM0QOy_elF0MjXiPzxrfWDLGZD_moFwBS-uRdRgIBX1LzeeHRDr5-2TlM');"></div>

  <div class="relative z-10 flex w-full grow flex-col justify-center px-6">
    <div class="mx-auto flex w-full max-w-md flex-col items-center py-10">
      <div class="mb-8 flex items-center justify-center">
        <span class="material-symbols-outlined text-5xl text-primary">waves</span>
      </div>
      <h1 class="text-[#111718] dark:text-background-light tracking-tight text-[32px] font-bold leading-tight text-center pb-2">Inicia Sesión</h1>
      <p class="text-gray-600 dark:text-gray-300 text-base leading-normal pb-8 text-center">Accede a tu cuenta para continuar.</p>

      {% if form.non_field_errors %}
        <div class="w-full mb-4 rounded-lg border border-red-300 bg-red-50 text-red-700 p-3">
          {% for err in form.non_field_errors %}<p>{{ err }}</p>{% endfor %}
        </div>
      {% endif %}

      <form method="post" action="{% url 'login' %}" class="w-full space-y-4">
        {% csrf_token %}
        {% if next %}<input type="hidden" name="next" value="{{ next }}" />{% endif %}

        <label class="flex flex-col w-full" for="{{ form.username.id_for_label }}">
          <p class="text-[#111718] dark:text-gray-200 text-base font-medium leading-normal pb-2">Correo o Usuario</p>
          <input type="text" name="{{ form.username.name }}" id="{{ form.username.id_for_label }}"
                 value="{{ form.username.value|default_if_none:'' }}"
                 class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#111718] dark:text-white focus:outline-0 border border-[#dbe5e6] dark:border-gray-700 bg-white/50 dark:bg-white/5 backdrop-blur-sm focus:border-primary focus:ring-2 focus:ring-primary/20 h-14 placeholder:text-gray-500 dark:placeholder:text-gray-400 p-[15px] text-base"
                 placeholder="ej: tu@email.com" />
          {% if form.username.errors %}
            <p class="text-sm text-red-600 mt-1">{{ form.username.errors|striptags }}</p>
          {% endif %}
        </label>

        <label class="flex flex-col w-full" for="{{ form.password.id_for_label }}">
          <p class="text-[#111718] dark:text-gray-200 text-base font-medium leading-normal pb-2">Contraseña</p>
          <div class="flex w-full flex-1 items-stretch rounded-lg">
            <input type="password" name="{{ form.password.name }}" id="{{ form.password.id_for_label }}"
                   class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-l-lg text-[#111718] dark:text-white focus:outline-0 border border-[#dbe5e6] dark:border-gray-700 bg-white/50 dark:bg-white/5 backdrop-blur-sm focus:border-primary focus:ring-2 focus:ring-primary/20 h-14 placeholder:text-gray-500 dark:placeholder:text-gray-400 p-[15px] border-r-0 pr-2 text-base"
                   placeholder="Ingresa tu contraseña" />
            <button type="button" aria-label="Toggle password visibility"
                    class="text-gray-500 dark:text-gray-400 flex border border-[#dbe5e6] dark:border-gray-700 bg-white/50 dark:bg-white/5 backdrop-blur-sm items-center justify-center pr-[15px] rounded-r-lg border-l-0"
                    onclick="const p=document.getElementById('{{ form.password.id_for_label }}'); p.type=p.type==='password'?'text':'password';">
              <span class="material-symbols-outlined">visibility</span>
            </button>
          </div>
          {% if form.password.errors %}
            <p class="text-sm text-red-600 mt-1">{{ form.password.errors|striptags }}</p>
          {% endif %}
        </label>

        <div class="flex justify-between items-center w-full mt-2">
          <label class="flex items-center gap-2">
            <input class="form-checkbox h-4 w-4 rounded border-gray-300 dark:border-gray-600 text-primary bg-gray-100 dark:bg-gray-700 focus:ring-primary" type="checkbox" name="remember" />
            <span class="text-sm text-gray-600 dark:text-gray-300">Recordarme</span>
          </label>
          <a class="text-sm font-medium text-primary hover:underline" href="{% url 'password_reset' %}">¿Olvidaste tu contraseña?</a>
        </div>

        <button type="submit" class="flex items-center justify-center w-full h-14 px-6 mt-4 rounded-lg bg-primary text-black text-base font-bold leading-normal transition-colors hover:bg-opacity-90">Ingresar</button>

        <div class="flex items-center my-6 gap-4">
          <div class="h-px flex-1 bg-gray-300 dark:bg-gray-700"></div>
          <span class="text-sm text-gray-500 dark:text-gray-400">o</span>
          <div class="h-px flex-1 bg-gray-300 dark:bg-gray-700"></div>
        </div>

        <a href="{% url 'social:begin' 'google-oauth2' %}{% if next %}?next={{ next }}{% endif %}"
           class="flex items-center justify-center w-full h-12 px-4 rounded-lg border border-[#dbe5e6] dark:border-gray-700 bg-white/50 dark:bg-white/5 text-[#111718] dark:text-white font-medium hover:bg-white">
          <span class="material-symbols-outlined mr-2">account_circle</span>
          Continuar con Google
        </a>
      </form>

      <p class="text-center text-sm text-gray-600 dark:text-gray-300 mt-8">
        ¿No tienes una cuenta? <a class="font-bold text-primary hover:underline" href="{% url 'signup' %}">Regístrate</a>
      </p>
    </div>
  </div>
</div>
{% endblock %}
